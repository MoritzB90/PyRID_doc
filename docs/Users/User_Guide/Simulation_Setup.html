<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simulation setup &mdash; PyRID 15.06.2022 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Molecules" href="Molecules.html" />
    <link rel="prev" title="User Guide" href="Contents.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> PyRID
            <img src="../../_static/PyRID_Logo_Render2_cropped.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Contents.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Simulation setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#berendsen-barostat">Berendsen barostat</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Molecules.html">Molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="Interaction_Potentials.html">Interaction potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reactions.html">Reactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Compartments.html">Compartments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Molecule_Distribution.html">Molecule distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Observables.html">Observables</a></li>
<li class="toctree-l2"><a class="reference internal" href="Run_Simulation.html">Run simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Evaluation.html">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Blender_Addon.html">Blender Add-on</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Examples/Contents.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Developer%20API/Contents.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Theory/Contents.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Validation/Contents.html">Validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../References.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/MoritzB90/PyRID">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UC4o41QLwsfeh0g981MZPl7w">Youtube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">license</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyRID</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="Contents.html">User Guide</a> &raquo;</li>
      <li>Simulation setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Users/User_Guide/Simulation_Setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="simulation-setup">
<h1>Simulation setup<a class="headerlink" href="#simulation-setup" title="Permalink to this heading"></a></h1>
<p>First, import pyrid</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyrid</span> <span class="k">as</span> <span class="nn">prd</span>
</pre></div>
</div>
<p>The user ‘communicates’ with PyRID via the Simulation class.
To configure a simulation system in PyRID, some parameters need to be defined by the user.
These include the</p>
<ol class="arabic simple">
<li><p>simulation box size (in nm),</p></li>
<li><p>integration time step (in ns),</p></li>
<li><p>temperature (in Kelvin),</p></li>
<li><p>solvent viscosity (in kJ/(nm^3 ns)),</p></li>
<li><p>number of simulation steps,</p></li>
</ol>
<p>Then, a simulation can be set up by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">nsteps</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, energy is given in units of kJ/mol, length in nanometer and time in ns. The user can, however, define different units such as micrometer and s.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">nsteps</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span>
                            <span class="n">length_unit</span> <span class="o">=</span> <span class="s1">&#39;nanometer&#39;</span><span class="p">,</span>
                            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition, there are many other parameters the user can define. For example the directories for files and figures:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">nsteps</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span>
                            <span class="n">length_unit</span> <span class="o">=</span> <span class="s1">&#39;nanometer&#39;</span><span class="p">,</span>
                            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span><span class="p">,</span>
                            <span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;my_directory/&#39;</span><span class="p">,</span>
                            <span class="n">fig_path</span> <span class="o">=</span> <span class="s1">&#39;Figures/&#39;</span><span class="p">,</span>
                            <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;my_first_simulation&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, PyRID writes the molecule trajectories into a .xyz file with a stride of 100. You may change these settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">nsteps</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span>
                            <span class="n">length_unit</span> <span class="o">=</span> <span class="s1">&#39;nanometer&#39;</span><span class="p">,</span>
                            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span><span class="p">,</span>
                            <span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;my_directory/&#39;</span><span class="p">,</span>
                            <span class="n">fig_path</span> <span class="o">=</span> <span class="s1">&#39;Figures/&#39;</span><span class="p">,</span>
                            <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;my_first_simulation&#39;</span><span class="p">,</span>
                            <span class="n">write_trajectory</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">stride</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>ALso, the user can set a random seed. Thereby, a simulation will be exactly reproducible:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">nsteps</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span>
                            <span class="n">length_unit</span> <span class="o">=</span> <span class="s1">&#39;nanometer&#39;</span><span class="p">,</span>
                            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span><span class="p">,</span>
                            <span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;my_directory/&#39;</span><span class="p">,</span>
                            <span class="n">fig_path</span> <span class="o">=</span> <span class="s1">&#39;Figures/&#39;</span><span class="p">,</span>
                            <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;my_first_simulation&#39;</span><span class="p">,</span>
                            <span class="n">write_trajectory</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">stride</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                            <span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>PyRID supports three different types of boundary conditions: ‘periodic’, ‘repulsive’, ‘fixed concentration’. By default, PyRID assumes periodic boundary conditions. If you want to use repulsive boundary conditions, you can set a wall_force constant. By default wall_force = 100. The same constant is also used to resolve collisions of molecules with mesh compartment walls.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">nsteps</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span>
                            <span class="n">length_unit</span> <span class="o">=</span> <span class="s1">&#39;nanometer&#39;</span><span class="p">,</span>
                            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span><span class="p">,</span>
                            <span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;my_directory/&#39;</span><span class="p">,</span>
                            <span class="n">fig_path</span> <span class="o">=</span> <span class="s1">&#39;Figures/&#39;</span><span class="p">,</span>
                            <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;my_first_simulation&#39;</span><span class="p">,</span>
                            <span class="n">write_trajectory</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">stride</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                            <span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                            <span class="n">boundary_condition</span> <span class="o">=</span> <span class="s1">&#39;repulsive&#39;</span><span class="p">,</span>
                            <span class="n">wall_force</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes you may don’t want to specify the number of time steps but rather limit the total simulation time. In this case, you can pass sim_time (given in seconds, e.g. 7200 s for a 2 hour simulation) instead of nsteps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],</span>
                            <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">Temp</span> <span class="o">=</span> <span class="mf">293.15</span><span class="p">,</span>
                            <span class="n">eta</span> <span class="o">=</span> <span class="mf">1e-21</span><span class="p">,</span>
                            <span class="n">sim_time</span> <span class="o">=</span> <span class="mi">7200</span><span class="p">)</span>
</pre></div>
</div>
<p>Once an instance of the Simulation class is created we may continue configuring our simulation.
For long simulations, it is often convenient to add checkpoints, i.e. PyRID saves the state of the system at certain points. checkpoints are saved in numpy .npz files. You can add checkpoints by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span><span class="o">.</span><span class="n">add_checkpoints</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;checkpoints/&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, 1000 sets the stride, i.e. PyRID will save the System state each 100th step, “checkpoints/” is the directory, and 10 sets the maximum number of saved files.
If you want to load a checkpoint, you can do so by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="s1">&#39;my_first_simulation&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>, where ‘my_first_simulation’ is the file name and 0 the index of the saved file. In our example there are 10 saved files with indices 0-9. Note that PyRID currently does not save the complete system configuration. That mean, all the molecule types, particles, interactions and reactions need to be declared again, before you can load a checkpoint file. For future releases it would, however, be nice to be able to save complete project files which can then be loaded.
In the next chapter you learn how to add molecules to the system.</p>
<section id="berendsen-barostat">
<h2>Berendsen barostat<a class="headerlink" href="#berendsen-barostat" title="Permalink to this heading"></a></h2>
<p>PyRID also supports NPT ensemble simulations using a Berendsen barostat. A barostat can be setup as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># target pressure</span>
<span class="n">Tau_P</span><span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># time constant</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># time step at which to start the barostat</span>

<span class="n">Simulation</span><span class="o">.</span><span class="n">add_barostat_berendsen</span><span class="p">(</span><span class="n">Tau_P</span><span class="p">,</span> <span class="n">P0</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Contents.html" class="btn btn-neutral float-left" title="User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Molecules.html" class="btn btn-neutral float-right" title="Molecules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Moritz F P Becker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>