<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compartments &mdash; PyRID 15.06.2022 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Molecule distribution" href="Molecule_Distribution.html" />
    <link rel="prev" title="Reactions" href="Reactions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> PyRID
            <img src="../../_static/PyRID_Logo_Render2_cropped.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Contents.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Simulation_Setup.html">Simulation setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="Molecules.html">Molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="Interaction_Potentials.html">Interaction potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reactions.html">Reactions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Compartments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecule-collision-types">Molecule collision types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Molecule_Distribution.html">Molecule distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Observables.html">Observables</a></li>
<li class="toctree-l2"><a class="reference internal" href="Run_Simulation.html">Run simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Evaluation.html">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Blender_Addon.html">Blender Add-on</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Examples/Contents.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Developer%20API/Contents.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Theory/Contents.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers/Validation/Contents.html">Validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../References.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/MoritzB90/PyRID">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UC4o41QLwsfeh0g981MZPl7w">Youtube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">license</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyRID</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="Contents.html">User Guide</a> &raquo;</li>
      <li>Compartments</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Users/User_Guide/Compartments.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="compartments">
<span id="userguide-compartments"></span><h1>Compartments<a class="headerlink" href="#compartments" title="Permalink to this heading"></a></h1>
<p>In order for cells to be able to organize or even be able to execute the uncountable number of different processes it needs to be able to compartmentalize these processes. By far the most common method of compartmentalization is the phospholipid bilayer from which cell membranes are formed. Cell membrane serves various functions:</p>
<ol class="arabic simple">
<li><p>It forms a diffusive barrier for ions and molecules, such as proteins,</p></li>
<li><p>Proteins can be embedded in the membrane where they freely diffuse or become anchored to other proteins</p></li>
<li><p>The membrane can interact with other molecules via surface charges</p></li>
<li><p>By the interaction with protein filaments such as actin and microtubules membranes can take various diverse forms.</p></li>
<li><p>Membrane compartments (organelles) can fuse with other membrane compartments (vesicles) via exocytosis. Exocytosis is used to transport cargo such as neurotransmitters from one side of a membrane to the other.</p></li>
<li><p>Parts of the membrane and its transmembrane proteins can be seperated by endocytosis.</p></li>
</ol>
<p>This list could be continued. However, it already shows that membranes are an essential part of cells. Therefore, in PyRID membrane compartments can be represented by triangulated meshes. Meshes are a highly coarse grained representation of the complex structure that is the plasma membrane. Therefore, it is not possible to account for all the membrane properties. However, two essential features can be accounted for:</p>
<ol class="arabic simple">
<li><p>The diffusion of molecules in the membrane surface,</p></li>
<li><p>the diffusive barrier.</p></li>
</ol>
<p>Processes such as exocytosis can be accounted for by ‘release events’ (see <a class="reference internal" href="Molecule_Distribution.html#userguide-distribution"><span class="std std-ref">Molecule distribution</span></a>).</p>
<section id="meshes">
<h2>Meshes<a class="headerlink" href="#meshes" title="Permalink to this heading"></a></h2>
<p>PyRID only supports triangulated meshes in the .obj format but does not support all features of the .obj format. Therefore, I recommend to use the PyRID add-on for Blender that can be used to export meshes to .obj files that PyRID can handle. Your mesh can be a 3D scan or modeled by hand. However, the mesh should be a manifold-mesh, i.e., it should not contain any holes.
The .obj file may contain several meshes. Each will be handled as a separate compartment by PyRID.
In addition, you can define face groups, which are groups of mesh triangles. These can be used, e.g., to distributed molecules in specific regions of the mesh surface.</p>
<p>Once you have a correctly formatted mesh, you can import it into PyRID by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vertices</span><span class="p">,</span> <span class="n">triangles</span><span class="p">,</span> <span class="n">Compartments</span> <span class="o">=</span> <span class="n">prd</span><span class="o">.</span><span class="n">load_compartments</span><span class="p">(</span><span class="s1">&#39;Compartments/my_mesh.obj&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, vertices is an array, containing all the vertices of all the meshes in my_mesh.obj and triangles contains the indices of all the vertices that make up the individual mesh faces. Compartments is a dictionary containing for each compartment the list of triangle indices and the triangle indices for the face groups, if defined.
The mesh has only been read but not yet added to the simulation. This can be done by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_scale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Simulation</span><span class="o">.</span><span class="n">set_compartments</span><span class="p">(</span><span class="n">Compartments</span><span class="p">,</span> <span class="n">triangles</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">mesh_scale</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, mesh_scale is a parameter, by which we can scale the mesh, if needed. By default, mesh_scale = 1.
PyRID allows us to visualize the individual compartments using the 3D capabilities of the plotly library (figure <a class="reference internal" href="#fig-meshes"><span class="std std-numref">Fig. 5</span></a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_compartments</span><span class="p">(</span><span class="n">Simulation</span><span class="p">,</span> <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="fig-meshes">
<a class="reference internal image-reference" href="../../_images/Meshes.png"><img alt="../../_images/Meshes.png" src="../../_images/Meshes.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text"><strong>Mesh compartments.</strong> The intersection of the mesh with the simulation box is highlighted in yellow. These triangles will be rendered transparent is we us periodic or fixed concentration boundary conditions. The blue faces highlight face groups with no specific purpose. Face groups can, e.g., be used for molecule distribution. On the right, the simulation box border is visualized.</span><a class="headerlink" href="#fig-meshes" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="molecule-collision-types">
<h2>Molecule collision types<a class="headerlink" href="#molecule-collision-types" title="Permalink to this heading"></a></h2>
<p>PyRID somehow needs to resolve the collision of molecules with the mesh. If the expected displacement of a molecule per time step is small compared to the particles radii, collisions can be resolved by a repulsive interaction potential. This approach is relatively accurate. However, PyRID uses a fairly simple approach in order to calculate the repulsive forces between molecules an meshes and more accurate solutions exists. More complex methods are mainly developed and used for discrete element method simulations.
For fast moving molecules or atoms, however, the force approach does not work. Instead, PyRID uses a ray tracing approach similar to what is used in, e.g., <a class="reference external" href="https://mcell.org/">MCell</a>. Thereby, the displacement vector is traced through the simualtion volume and any collisions are resolved via reflection. However, PyRID does not automatically decide whether to use the force, or the ray tracing approach. Instead, we can set the collision type when adding a new molecule type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulation</span><span class="o">.</span><span class="n">register_molecule_type</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">C_pos</span><span class="p">,</span> <span class="n">C_types</span><span class="p">,</span> <span class="n">collision_type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, collision_type = 0 (force approach).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Reactions.html" class="btn btn-neutral float-left" title="Reactions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Molecule_Distribution.html" class="btn btn-neutral float-right" title="Molecule distribution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Moritz F P Becker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>