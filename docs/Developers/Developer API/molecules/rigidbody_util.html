<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rigidbody_util &mdash; PyRID 15.06.2022 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/design-tabs.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="hydro_util" href="hydro_util.html" />
    <link rel="prev" title="particles_util" href="particles_util.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> PyRID
            <img src="../../../_static/PyRID_Logo_Render2_cropped.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/User_Guide/Contents.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/Examples/Contents.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Contents.html">Developer API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../data_structures.html">data_structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation.html">evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../geometry.html">geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math.html">math</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../molecules.html">molecules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="particles_util.html">particles_util</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">rigidbody_util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rbs">RBs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hydro_util.html">hydro_util</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../observables.html">observables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reactions.html">reactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../system.html">system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../run.html">run</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Theory/Contents.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Validation/Contents.html">Validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../References.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/MoritzB90/PyRID">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UC4o41QLwsfeh0g981MZPl7w">Youtube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">license</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyRID</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Contents.html">Developer API</a> &raquo;</li>
          <li><a href="../molecules.html">molecules</a> &raquo;</li>
      <li>rigidbody_util</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/Developers/Developer API/molecules/rigidbody_util.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rigidbody-util">
<h1>rigidbody_util<a class="headerlink" href="#rigidbody-util" title="Permalink to this heading"></a></h1>
<p>Short description</p>
<section id="rbs">
<h2>RBs<a class="headerlink" href="#rbs" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyrid.molecules.rigidbody_util.</span></span><span class="sig-name descname"><span class="pre">RBs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs" title="Permalink to this definition"></a></dt>
<dd><p>A rigid body/bead model object is defined by a set of particles with fixed positions relative to the body center. 
In our framework we use rigid bodies as a course grained representation of molecules.
A rigid bead model has a center of diffusion around which the rigid bead model rotates in response to torque and rotational diffusion. 
By default a surface molecule is bound to the mesh surface at the center of diffusion or shifted by an offset passed by the user.
A rigid bodies topology is described by a list of particle indices. A RBs instance is initializeed without any molecules. Use the add_RB method to add molecules to the list.</p>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Data</strong><span class="classifier"><cite>array_like</cite></span></dt><dd><p>Numpy structured array containing all data that define a moelcules state.
<cite>dtype = np.dtype([(‘next’, np.uint64),(‘name’, ‘U20’),(‘id’, np.int32),(‘type_id’, np.int32), (‘pos’, np.float64, (3,)), (‘dX’, np.float64, (3,)), (‘force’, np.float64, (3,)), (‘torque’, np.float64, (3,)), (‘topology’, np.int32, (20,)),(‘topology_N’, np.int32),(‘q’, np.float64, (4,)), (‘dq’, np.float64, (4,)),(‘B’, np.float64, (4,4)),(‘orientation_quat’, np.float64, (3,3)),(‘mu_tb’, np.float64, (3,3)),(‘mu_rb’, np.float64, (3,3)),(‘mu_tb_sqrt’, np.float64, (3,3)),(‘mu_rb_sqrt’, np.float64, (3,3)),(‘Dtrans’, np.float64),(‘Drot’, np.float64),(‘radius’, np.float64), (‘loc_id’, np.int32), (‘compartment’, np.int64), (‘triangle_id’, np.int32), (‘pos_last’, np.float64, (3,)), (‘Theta_t’, np.float64, (3,)), (‘Theta_r’, np.float64, (3,)), (‘posL’, np.float64, (3,)), (‘collision_type’, np.int64), (‘next_transition’, np.float64), ],  align=True)</cite></p>
</dd>
<dt><strong>pos</strong><span class="classifier">array</span></dt><dd><p>position of the center of mass</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>add_RB(name, compartment, System, Particles, vol_surf_id)</strong></p></td>
<td><p>Adds a new rigid body molecule to the Data array.</p></td>
</tr>
<tr class="row-even"><td><p><strong>next_um_reaction(System, i)</strong></p></td>
<td><p>Calculates the time of the next unimolecular reaction.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_triangle(tri_id, i)</strong></p></td>
<td><p>Set the triangle id of a surface molecule.</p></td>
</tr>
<tr class="row-even"><td><p><strong>add_particle(pi, i)</strong></p></td>
<td><p>Adds a particle to the molecule topology list.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_topology(System, Particles, i)</strong></p></td>
<td><p>Updates the positions of all particles in the molecule.</p></td>
</tr>
<tr class="row-even"><td><p><strong>place_particles(pos, types, radii, System, Particles, i)</strong></p></td>
<td><p>Registeres the particle positions, radii and types of a molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_pos(Particles, System, pos, i)</strong></p></td>
<td><p>Sets the position of moelcule i to pos.</p></td>
</tr>
<tr class="row-even"><td><p><strong>update_force_torque(Particles, i)</strong></p></td>
<td><p>Updates the total force and torque acting on molecule i.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_B(i)</strong></p></td>
<td><p>Updates matrix B which is used to update the moelcule’s rotation quaternion.</p></td>
</tr>
<tr class="row-even"><td><p><strong>calc_orientation_quat(i)</strong></p></td>
<td><p>Calculated the orientation matrix of the molecule from it’s’ rotation quaternion.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_orientation_quat(Particles, q, System, i)</strong></p></td>
<td><p>Rotates the molecule according to quaternion q.</p></td>
</tr>
<tr class="row-even"><td><p><strong>update_orientation_quat(i)</strong></p></td>
<td><p>Updates the molecules orientation matrix and the B-matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_dq(System, i)</strong></p></td>
<td><p>Updates the rotational displacement dq.</p></td>
</tr>
<tr class="row-even"><td><p><strong>update_dX(System, i)</strong></p></td>
<td><p>Updates the translational displacement dX.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_particle_pos(Particles, System, i)</strong></p></td>
<td><p>Updates the position and orientation of volume molecule i (and all its particles).</p></td>
</tr>
<tr class="row-even"><td><p><strong>update_particle_pos_2D(System, Particles, i)</strong></p></td>
<td><p>Updates the position and orientation of surface molecule i (and all its particles).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>rescale_pos(Particles, System, mu, i)</strong></p></td>
<td><p>Rescales the position molecule i’s origin by a factor mu (needed for the Berendsen barostat).</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.add_RB">
<span class="sig-name descname"><span class="pre">add_RB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compartment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol_surf_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.add_RB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.add_RB" title="Permalink to this definition"></a></dt>
<dd><p>Adds a rigid bead molecule to the system.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>name</strong><span class="classifier"><cite>string</cite></span></dt><dd><p>name of the molecule type</p>
</dd>
<dt><strong>compartment</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Id of the compartment the moelcule sites in</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of System class</p>
</dd>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.add_particle">
<span class="sig-name descname"><span class="pre">add_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.add_particle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.add_particle" title="Permalink to this definition"></a></dt>
<dd><p>Adds a new particle to the rigid bead molecule topology.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pi</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Particle index</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>IndexError(‘Maximum number of particles per molecule (20) reached! To change this, currently you have to manualy set the maximum size in rigidbody_util.py’)</dt><dd><p>by default, currenztly, a maximum number of 20 particles per rigid bead molecule type is allowed. The user may incerase this limit by increasing the size of the field ‘topology’ in the structured numpy array dtype ‘item_t_RB’ (see rigi_body_util.py)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.calc_orientation_quat">
<span class="sig-name descname"><span class="pre">calc_orientation_quat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.calc_orientation_quat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.calc_orientation_quat" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the orientation/rotation matrix of moelcule i from it’s rotational quaternion q.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The rotation matrix corresponding to a unit rotation quaternion <span class="math notranslate nohighlight">\(\boldsymbol{q} = [q_0, q_1, q_2, q_3]\)</span> can be calculated by:</p>
<div class="math notranslate nohighlight" id="equation-rotationmatrix">
<span class="eqno">(1)<a class="headerlink" href="#equation-rotationmatrix" title="Permalink to this equation"></a></span>\[\begin{split}\boldsymbol{A}
= 
\begin{pmatrix}
2(q_0^2+q_1^2)-1 &amp; 2(q_1 q_2-q_0 q_3) &amp; 2(q_1 q_3-q_0 q_2) \\
2(q_1 q_2-q_0 q_3) &amp; 2(q_0^2+q_2^2)-1 &amp; 2(q_2 q_3-q_0 q_1) \\
2(q_1 q_3-q_0 q_2) &amp; 2(q_2 q_3-q_0 q_1) &amp; 2(q_0^2+q_3^2)-1 \\
\end{pmatrix}.  \end{split}\]</div>
<p>(Note: There exist several equivalent ways to calculate the rotation matrix, which share the way the off-diagonal elements are calculated but slightly differ in the diagonal elements)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.next_um_reaction">
<span class="sig-name descname"><span class="pre">next_um_reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.next_um_reaction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.next_um_reaction" title="Permalink to this definition"></a></dt>
<dd><p>Draws the time point of the next unimolecular diffusion for moelcule i.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>System</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of System class</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For unimolecular reactions we can draw the time point of the next reaction from a distribution using a variant of the Gillespie Stochastic Simulation Algorithm (SSA) <span id="id1">Stiles and Bartol [<a class="reference internal" href="../../../References.html#id7" title="Joel Stiles and Thomas Bartol. Monte Carlo Methods for Simulating Realistic Synaptic Microphysiology Using MCell, pages 87–127. CRC Press, 2001. doi:10.1201/9781420039290.ch4.">9</a>]</span>, <span id="id2">Erban <em>et al.</em> [<a class="reference internal" href="../../../References.html#id6" title="Radek Erban, Jonathan Chapman, and Philip Maini. A practical guide to stochastic simulations of reaction-diffusion processes. 2007. doi:10.48550/ARXIV.0704.1908.">10</a>]</span>. For a single molecule having <span class="math notranslate nohighlight">\(n\)</span> possible transition reactions/reaction paths each having a reaction rate <span class="math notranslate nohighlight">\(k_i\)</span>, let <span class="math notranslate nohighlight">\(k_t = \sum_i^n k_i\)</span> be the total reaction rate. Then, we can draw the time point of the next reaction from:</p>
<div class="math notranslate nohighlight">
\[\tau = \frac{1}{k_t} \ln\Big[\frac{1}{r}\Big],\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is a random number uninformly distributed in (0,1).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.place_particles">
<span class="sig-name descname"><span class="pre">place_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_membrane</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.place_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.place_particles" title="Permalink to this definition"></a></dt>
<dd><p>Places all the particles that make up the topology of rigid bead molecule i given a list of partcile types, positions and radii.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pos</strong><span class="classifier"><cite>float64[:,3]</cite></span></dt><dd><p>Array of particle positions</p>
</dd>
<dt><strong>types</strong><span class="classifier"><cite>array_like</cite></span></dt><dd><p>Array of strings of particle type names</p>
</dd>
<dt><strong>radii</strong><span class="classifier"><cite>float64[:]</cite></span></dt><dd><p>Array of particle radii</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of System class</p>
</dd>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
<dt><strong>h_membrane</strong><span class="classifier"><cite>float64</cite></span></dt><dd><p>Additive factor by which the particle positions are shifted along the z axis of the local coordinate frame. Thereby, the relative position to the center of diffusion is shifted. ‘h_membrane’ should only be used to change the position at which a surface molecule sits in the mesh surface.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.rescale_pos">
<span class="sig-name descname"><span class="pre">rescale_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.rescale_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.rescale_pos" title="Permalink to this definition"></a></dt>
<dd><p>Rescales the position of molecule i by a multiplicative factor mu. This method is only used for the Berendsen barostat.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>obj</cite></span></dt><dd><p>Instance of System class.</p>
</dd>
<dt><strong>mu</strong><span class="classifier"><cite>float64</cite></span></dt><dd><p>Multiplicative factor by which to scale the molecule position.</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Index of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dtype</dt><dd><p>Some information</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError (just an example)</dt><dd><p>Brief explanation of why/when this exception is raised</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.set_orientation_quat">
<span class="sig-name descname"><span class="pre">set_orientation_quat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.set_orientation_quat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.set_orientation_quat" title="Permalink to this definition"></a></dt>
<dd><p>Sets the orientation of rigid bead molecule i given a rotation quaternion q.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>q</strong><span class="classifier"><cite>float64[4]</cite></span></dt><dd><p>Rotation quanternion</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of System class</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.set_pos">
<span class="sig-name descname"><span class="pre">set_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.set_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.set_pos" title="Permalink to this definition"></a></dt>
<dd><p>Sets the position of rigid bead molecule i.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of System class</p>
</dd>
<dt><strong>pos</strong><span class="classifier"><cite>float64[3]</cite></span></dt><dd><p>Position of the molecule center</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.set_triangle">
<span class="sig-name descname"><span class="pre">set_triangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tri_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.set_triangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.set_triangle" title="Permalink to this definition"></a></dt>
<dd><p>Sets the triangle id for surface molecule i.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>triangle_id</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Index of the triangle</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_B">
<span class="sig-name descname"><span class="pre">update_B</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_B"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_B" title="Permalink to this definition"></a></dt>
<dd><p>Calculates matrix B used in the quaternion propagator (see RBs.dq()).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When propagating the cartesian coordinates of the rigid bead moelcule’s center of diffusion we need to account for the orientation of the moelcule. This is readily done by applying the rotation matrix A to the molecule’s mobility tensor (Note: to rotate a tensor we need to apply the rotation matrix twice: <span class="math notranslate nohighlight">\(\mu^{lab} = A \cdot \mu^{local} \cdot A^{-1}\)</span>). However, things are more complicated when deriving the propagator for the rotation quaternion. Here, the rotation matrix is partially replaced by matrix <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> which accounts for the fact that we are using a four dimensional coordinate set of quaternions instead of three euler angles. In other terms, <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> relates the angular velocity in the local frame to the quaternion velocity ( <span class="math notranslate nohighlight">\(\frac{d\boldsymbol{q}}{dt} = \boldsymbol{B} \boldsymbol{\omega}^{local}\)</span> ) <span id="id3">[<a class="reference internal" href="../../../References.html#id20" title="Ioana M. Ilie, Wim J. Briels, and Wouter K. den Otter. An elementary singularity-free rotational brownian dynamics algorithm for anisotropic particles. The Journal of Chemical Physics, 142(11):114103, mar 2015. doi:10.1063/1.4914322.">11</a>]</span>.
The matrix <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-b-matrix">
<span class="eqno">(2)<a class="headerlink" href="#equation-b-matrix" title="Permalink to this equation"></a></span>\[\begin{split}\boldsymbol{B}
= \frac{1}{2}
\begin{pmatrix}
q_0 &amp; -q_1 &amp; -q_2 &amp; -q_3 \\
q_1 &amp; q_0 &amp; -q_3 &amp; q_2 \\
q_2 &amp; q_3 &amp; q_0 &amp; -q_1 \\
q_3 &amp; -q_2 &amp; q_1 &amp; q_0 \\
\end{pmatrix},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is the current rotational quaternion of molecule i.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_dX">
<span class="sig-name descname"><span class="pre">update_dX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_dX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_dX" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the translational displacemnt of molecule i using the Brownian dynamics algorithm for anisotropic particles introduced by <span id="id4">Ilie <em>et al.</em> [<a class="reference internal" href="../../../References.html#id20" title="Ioana M. Ilie, Wim J. Briels, and Wouter K. den Otter. An elementary singularity-free rotational brownian dynamics algorithm for anisotropic particles. The Journal of Chemical Physics, 142(11):114103, mar 2015. doi:10.1063/1.4914322.">11</a>]</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>System</strong><span class="classifier"><cite>obj</cite></span></dt><dd><p>Instance of System class.</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Index of the molecule.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The translational displacement of an anisotropic particles due to Brownian motion and an external force <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> can be expressed by <span id="id5">[<a class="reference internal" href="../../../References.html#id20" title="Ioana M. Ilie, Wim J. Briels, and Wouter K. den Otter. An elementary singularity-free rotational brownian dynamics algorithm for anisotropic particles. The Journal of Chemical Physics, 142(11):114103, mar 2015. doi:10.1063/1.4914322.">11</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-dx">
<span class="eqno">(3)<a class="headerlink" href="#equation-dx" title="Permalink to this equation"></a></span>\[\begin{split}\begin{align*}
R_{\alpha}(t+\Delta t) - R_{\alpha}(t) = &amp; A_{\alpha \gamma} \mu_{\gamma \delta}^{tb} A_{\beta \delta} F_{\beta} \Delta t \\
&amp; + A_{\alpha \gamma}(\sqrt{\boldsymbol{\mu}^{tb}})_{\gamma \beta} \Theta_{\beta}^t \sqrt{2 k_B T \Delta t},
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is the rotation matrix and <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^{tb}\)</span> the translational mobility tensor of the molecule in the body fixed frame (as opposed to the lab frame of reference). <span class="math notranslate nohighlight">\(\boldsymbol{\Theta}^t\)</span> is a normal distributed random vector describing the random movement of the molecule due to collisions with the fluid molecules. <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^{tb}\)</span> should be a real, positive semidefinite matrix to have proper physical meaning <span id="id6">[<a class="reference internal" href="../../../References.html#id22" title="Marc Niethammer, Raul San Jose Estepar, Sylvain Bouix, Martha Shenton, and Carl-Fredrik Westin. On diffusion tensor estimation. In 2006 International Conference of the IEEE Engineering in Medicine and Biology Society. IEEE, aug 2006. doi:10.1109/iembs.2006.259826.">12</a>]</span> . In this case, there exists a unique square root of the matrix <span class="math notranslate nohighlight">\(\sqrt{\boldsymbol{\mu}^{tb}}\)</span>, which can be found via diagonalization (see geometry_util.Transform:Util.sqrtM()). Latin indices run from 0 to 3 and Greek indices run from 1 to 3.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_dq">
<span class="sig-name descname"><span class="pre">update_dq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_dq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_dq" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the rotational displacemnt of molecule i using the Brownian dynamics algorithm for anisotropic particles introduced by <span id="id7">Ilie <em>et al.</em> [<a class="reference internal" href="../../../References.html#id20" title="Ioana M. Ilie, Wim J. Briels, and Wouter K. den Otter. An elementary singularity-free rotational brownian dynamics algorithm for anisotropic particles. The Journal of Chemical Physics, 142(11):114103, mar 2015. doi:10.1063/1.4914322.">11</a>]</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>System</strong><span class="classifier"><cite>obj</cite></span></dt><dd><p>Instance of System class.</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Index of the molecule.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The rotational displacement of an anisotropic particles due to Brownian motion and an external torque <span class="math notranslate nohighlight">\(\boldsymbol{T}\)</span> can be expressed by <span id="id8">[<a class="reference internal" href="../../../References.html#id20" title="Ioana M. Ilie, Wim J. Briels, and Wouter K. den Otter. An elementary singularity-free rotational brownian dynamics algorithm for anisotropic particles. The Journal of Chemical Physics, 142(11):114103, mar 2015. doi:10.1063/1.4914322.">11</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-dq">
<span class="eqno">(4)<a class="headerlink" href="#equation-dq" title="Permalink to this equation"></a></span>\[\begin{split}\begin{align*}
q_{a}(t+\Delta t) - q_{a}(t) = &amp; B_{a \alpha} \mu_{\alpha \beta}^{rb} A_{\gamma \beta} T_{\gamma} \Delta t \\
&amp; + B_{a \alpha}(\sqrt{\boldsymbol{\mu}^{rb}})_{\alpha \beta} \Theta_{\beta}^q \sqrt{2 k_B T \Delta t} + \lambda_q q_a,
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is the rotation matrix and <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^{rb}\)</span> the rotational mobility tensor of the molecule in the body fixed frame (as opposed to the lab frame of reference). <span class="math notranslate nohighlight">\(\boldsymbol{\Theta}^q\)</span> is a normal distributed random vector describing the random rotational movement of the molecule due to collisions with the fluid molecules. <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^{rb}\)</span> should be a real, positive semidefinite matrix to have proper physical meaning <span id="id9">[<a class="reference internal" href="../../../References.html#id22" title="Marc Niethammer, Raul San Jose Estepar, Sylvain Bouix, Martha Shenton, and Carl-Fredrik Westin. On diffusion tensor estimation. In 2006 International Conference of the IEEE Engineering in Medicine and Biology Society. IEEE, aug 2006. doi:10.1109/iembs.2006.259826.">12</a>]</span>. In this case, there exists a unique square root of the matrix <span class="math notranslate nohighlight">\(\sqrt{\boldsymbol{\mu}^{rb}}\)</span>, which can be found via diagonalization (see geometry_util.Transform:Util.sqrtM()). Latin indices run from 0 to 3 and Greek indices run from 1 to 3.</p>
<p>The matrix <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-b-matrix-0">
<span class="eqno">(5)<a class="headerlink" href="#equation-b-matrix-0" title="Permalink to this equation"></a></span>\[\begin{split}\boldsymbol{B}
= \frac{1}{2q^4}
\begin{pmatrix}
q_0 &amp; -q_1 &amp; -q_2 &amp; -q_3 \\
q_1 &amp; q_0 &amp; -q_3 &amp; q_2 \\
q_2 &amp; q_3 &amp; q_0 &amp; -q_1 \\
q_3 &amp; -q_2 &amp; q_1 &amp; q_0 \\
\end{pmatrix}.         \end{split}\]</div>
<p>For infinitesimal time steps <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> preserves its unit length. However, for finite time step <span class="math notranslate nohighlight">\(\Delta t\)</span> an additional constraint needs to be added to ensure that <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> keeps its unit length. This is realized here by a constraint force in the last term, directed along <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span>. By solving the Langrange multiplier <span class="math notranslate nohighlight">\(\lambda_q\)</span> from the condition <span class="math notranslate nohighlight">\(q(t+\Delta t) = 1\)</span> we get the strength of the force. Denoting <span class="math notranslate nohighlight">\(\tilde{q}(t+ \Delta t)\)</span> as the uncopnstrained quaternion, <span class="math notranslate nohighlight">\(\lambda_q\)</span> is obtained from solving the quadratic equation</p>
<div class="math notranslate nohighlight" id="equation-lagrangemult">
<span class="eqno">(6)<a class="headerlink" href="#equation-lagrangemult" title="Permalink to this equation"></a></span>\[\lambda_q^2 + 2 \lambda_q \boldsymbol{q} \cdot \tilde{q}(t+ \Delta t)+ \tilde{q}^2(t+ \Delta t) = 1\]</div>
<p>Simple rescaling of the quaternion will change the sampled phase space distribution. However, in practice, the resulting error is marginal and since rescaling is fatser than solving the quadratic equation each time step, we currently do the rescaling. However, the more accurate method is mentioned here for compeleness.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_force_torque">
<span class="sig-name descname"><span class="pre">update_force_torque</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_force_torque"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_force_torque" title="Permalink to this definition"></a></dt>
<dd><p>Updates the total force and torque acting on rigid bead molecule i by summing over all forces and torques of its particles.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_orientation_quat">
<span class="sig-name descname"><span class="pre">update_orientation_quat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_orientation_quat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_orientation_quat" title="Permalink to this definition"></a></dt>
<dd><p>Updates the rotation matrix of rigid bead molecule i, however, without updating the molecule and particle positions.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_particle_pos">
<span class="sig-name descname"><span class="pre">update_particle_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_particle_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_particle_pos" title="Permalink to this definition"></a></dt>
<dd><p>Updates the position of volume molecule i.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>obj</cite></span></dt><dd><p>Instance of System class.</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Index of the molecule.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">ray_march_volume</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_particle_pos_2D">
<span class="sig-name descname"><span class="pre">update_particle_pos_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_particle_pos_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_particle_pos_2D" title="Permalink to this definition"></a></dt>
<dd><p>Updates the position of surface molecule i.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>System</strong><span class="classifier"><cite>obj</cite></span></dt><dd><p>Instance of System class.</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Index of the molecule.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">ray_march_surface</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyrid.molecules.rigidbody_util.RBs.update_topology">
<span class="sig-name descname"><span class="pre">update_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">System</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrid/molecules/rigidbody_util.html#RBs.update_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrid.molecules.rigidbody_util.RBs.update_topology" title="Permalink to this definition"></a></dt>
<dd><p>Updates the positions of the particles that make up the topology of molecule i.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>System</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of System class</p>
</dd>
<dt><strong>Particles</strong><span class="classifier"><cite>object</cite></span></dt><dd><p>Instance of Particles class</p>
</dd>
<dt><strong>i</strong><span class="classifier"><cite>int64</cite></span></dt><dd><p>Molecule index</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="particles_util.html" class="btn btn-neutral float-left" title="particles_util" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hydro_util.html" class="btn btn-neutral float-right" title="hydro_util" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Moritz F P Becker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>