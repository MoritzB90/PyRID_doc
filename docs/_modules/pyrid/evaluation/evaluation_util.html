<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyrid.evaluation.evaluation_util &mdash; PyRID 15.06.2022 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/my_theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/design-tabs.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PyRID
              <img src="../../../_static/PyRID_Logo_Render2_cropped.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/User_Guide/Contents.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/Examples/Contents.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Users/Advanced/Contents.html">Advanced</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Developers/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Developers/Developer%20API/Contents.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Developers/Theory/Contents.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Developers/Validation/Contents.html">Validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../References.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/MoritzB90/PyRID">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UC4o41QLwsfeh0g981MZPl7w">Youtube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">license</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyRID</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyrid.evaluation.evaluation_util</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyrid.evaluation.evaluation_util</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">@author: Moritz F P Becker</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># import math</span>
<span class="c1"># import itertools</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># from mpl_toolkits.mplot3d.art3d import Poly3DCollection, Line3DCollection</span>
<span class="c1"># from mpl_toolkits.axes_grid1 import make_axes_locatable</span>
<span class="c1"># from itertools import product, combinations</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pyvis.network</span> <span class="kn">import</span> <span class="n">Network</span>

<span class="n">col</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="n">fontLgd</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="p">()</span>
<span class="n">fontLgd</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="s1">&#39;x-small&#39;</span><span class="p">)</span>

<span class="c1"># import plotly.graph_objects as go</span>
<span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
<span class="c1">#pio.renderers.default = &#39;svg&#39;</span>
<span class="n">pio</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s1">&#39;browser&#39;</span>


<span class="c1"># from ..evaluation import direct_coexistence_method_util as dcm</span>
<span class="kn">from</span> <span class="nn">..evaluation</span> <span class="kn">import</span> <span class="n">diffusion_util</span> <span class="k">as</span> <span class="n">diff</span>
<span class="kn">from</span> <span class="nn">..math.transform_util</span> <span class="kn">import</span> <span class="n">unique_pairing</span>

<span class="c1"># from ..observables_util.plot_util import plot_observable</span>

<div class="viewcode-block" id="Evaluation"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation">[docs]</a><span class="k">class</span> <span class="nc">Evaluation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Evaluation class has several methods that are useful for evaluating simulation results such as reading observables from hdf5 files, calculating MSDs </span>
<span class="sd">    and plotting observables and reactions graphs.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    file_name : `string`</span>
<span class="sd">        file name</span>
<span class="sd">    self.path : `string`</span>
<span class="sd">        file directory</span>
<span class="sd">    self.fig_path : `string`</span>
<span class="sd">        Figures directory</span>
<span class="sd">    self.Observables : `dictionary`</span>
<span class="sd">        Dictionary keeping the observables / system measures (except rdf).</span>
<span class="sd">    self.rdf : `dictionary`</span>
<span class="sd">        Dictionary keeping the rdf data.</span>
<span class="sd">    self.Measures : `list`</span>
<span class="sd">        List of all available observables / measures</span>
<span class="sd">    self.time_MSD : `dictionary`</span>
<span class="sd">        Dictionary keeping the time vectors for the MSD data.</span>
<span class="sd">    self.MSD_data : `dictionary`</span>
<span class="sd">        Dictionary keeping the MSD data for each molecule type.</span>
<span class="sd">    self.time_P2 : `dictionary`</span>
<span class="sd">        Dictionary keeping the time vectors for the P2 data.</span>
<span class="sd">    self.P2_data : `dictionary`</span>
<span class="sd">        Dictionary keeping the P2 data for each molecule type.</span>
<span class="sd">    self.P2_t : `dictionary`</span>
<span class="sd">        Dictionary keeping the theoretical P2 data for each molecule type.</span>
<span class="sd">    self.molecules_colors : `float64[:,4]`</span>
<span class="sd">        Molecule colors rgba [0,1].</span>
<span class="sd">    self.molecules_colors_rgb : `float64[:,3]`</span>
<span class="sd">        Molecule colors rgb [0,255].</span>
<span class="sd">    self.molecules_colors_hex : `list`</span>
<span class="sd">        Molecule colors hex.</span>
<span class="sd">    self.reactions_color : `dictionary`</span>
<span class="sd">        Reactions colors used in reaction graph plots.</span>
<span class="sd">    self.color_pallete : `dictionary`</span>
<span class="sd">        Color palettes used for the different observable plots (Energy, Pressure, ...)</span>
<span class="sd">    self.units : `dictionary`</span>
<span class="sd">        Unit system</span>
<span class="sd">    self.Temp : `float64`</span>
<span class="sd">        Temperature</span>
<span class="sd">    self.box_lengths : `float64[3]`</span>
<span class="sd">        Simulation box lengths</span>
<span class="sd">    self.dt : `float64`</span>
<span class="sd">        Integration time step</span>
<span class="sd">    self.eta : `float64`</span>
<span class="sd">        Viscosity</span>
<span class="sd">    self.kbt : `float64`</span>
<span class="sd">        Boltzmann constant times Temperature.</span>
<span class="sd">    self.nsteps : `int64`</span>
<span class="sd">        Number of simulation steps.</span>
<span class="sd">    self.Molecules : `dictionary`</span>
<span class="sd">        Molecule data per molecule type (bead position, bead radii, molecule volume, mobility tensors).</span>
<span class="sd">    self.hdf : `object`</span>
<span class="sd">        hdf5 file loaded using the h5py library.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    load_file(self, file_name, path = None)</span>
<span class="sd">        Loads an hdf5 file and extracts simulation properties such as temperature and simulation box size.</span>
<span class="sd">    read_molecule_data(self)</span>
<span class="sd">        Reads molecule data from the hdf5 file (mobility tensor, bead position and radii, etc.)</span>
<span class="sd">    load_hdf(self)</span>
<span class="sd">        Loads any hdf5 file from self.path directory.</span>
<span class="sd">    close_hdf(self)</span>
<span class="sd">        Closes the hdf5 file.</span>
<span class="sd">    MSD(self, time_interval, stride, Simulation, molecule)</span>
<span class="sd">        Calculates the Mean Squared Distance (MSD) from the molecule positions and from theory.</span>
<span class="sd">    plot_MSD(self, Simulation, molecule, save_fig = False, fig_name = None, fig_path=None)</span>
<span class="sd">        Plots the molecules&#39; Mean Squared Distance (MSD).</span>
<span class="sd">    P2(self, time_interval, stride, Simulation, molecule, theory_only = False, Delta_t = None)</span>
<span class="sd">        Calculates the rotational time correlation function P2 from the molecule orientations and from theory.</span>
<span class="sd">    plot_P2(self, Simulation, molecule, theory_only = False, save_fig = False, fig_name = None, fig_path=None, limits = None)</span>
<span class="sd">        Plots the rotational time correlation function P2.</span>
<span class="sd">    plot_rdf(self, mol_pairs, steps = [0], save_fig = False, fig_name = None , fig_path = None, average = False)</span>
<span class="sd">        Plots the radial distribution function (RDF) from the hdf5 file.</span>
<span class="sd">    read_observable(self, measure, sampling = None, molecules = &#39;All&#39;, educts = &#39;All&#39;, Reaction_Type = None, steps = &#39;All&#39;, file_path = None)</span>
<span class="sd">        Reads an observable / measure from the hdf5 file.</span>
<span class="sd">    plot_observable(self, measure, molecules = &#39;All&#39;, Reaction_Type = None, educt = None, bond_pairs = &#39;All&#39;, particle_educt = None, step = 0, save_fig = False, fig_name = None , fig_path = None, sampling = None, formats = [&#39;png&#39;], show = True)</span>
<span class="sd">        Plots an observable / measure found in the hdf5 file.</span>
<span class="sd">    plot_reactions_graph(self, Simulation, graph_type = &#39;Bimolecular&#39;, graph_subtype = &#39;&#39;)</span>
<span class="sd">        Plots a reactions graph using the pyvis library.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Evaluation.__init__"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;PyRID&#39;</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
            
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s1">&#39;Files&#39;</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s1">&#39;Figures&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;Figures&#39;</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span><span class="p">)</span> 
            <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
                <span class="c1"># directory already exists</span>
                <span class="k">pass</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rdf</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Measures</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial Tensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonds&#39;</span><span class="p">,</span> <span class="s1">&#39;Reactions&#39;</span><span class="p">,</span> <span class="s1">&#39;Force&#39;</span><span class="p">,</span> <span class="s1">&#39;Torque&#39;</span><span class="p">,</span> <span class="s1">&#39;RDF&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MSD_data</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P2_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P2_t</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.12156863</span><span class="p">,</span> <span class="mf">0.46666667</span><span class="p">,</span> <span class="mf">0.70588235</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.49803922</span><span class="p">,</span> <span class="mf">0.05490196</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.17254902</span><span class="p">,</span> <span class="mf">0.62745098</span><span class="p">,</span> <span class="mf">0.17254902</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.83921569</span><span class="p">,</span> <span class="mf">0.15294118</span><span class="p">,</span> <span class="mf">0.15686275</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.58039216</span><span class="p">,</span> <span class="mf">0.40392157</span><span class="p">,</span> <span class="mf">0.74117647</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.54901961</span><span class="p">,</span> <span class="mf">0.3372549</span> <span class="p">,</span> <span class="mf">0.29411765</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.89019608</span><span class="p">,</span> <span class="mf">0.46666667</span><span class="p">,</span> <span class="mf">0.76078431</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.49803922</span><span class="p">,</span> <span class="mf">0.49803922</span><span class="p">,</span> <span class="mf">0.49803922</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.7372549</span> <span class="p">,</span> <span class="mf">0.74117647</span><span class="p">,</span> <span class="mf">0.13333333</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.09019608</span><span class="p">,</span> <span class="mf">0.74509804</span><span class="p">,</span> <span class="mf">0.81176471</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.4</span>       <span class="p">,</span> <span class="mf">0.76078431</span><span class="p">,</span> <span class="mf">0.64705882</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.98823529</span><span class="p">,</span> <span class="mf">0.55294118</span><span class="p">,</span> <span class="mf">0.38431373</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.55294118</span><span class="p">,</span> <span class="mf">0.62745098</span><span class="p">,</span> <span class="mf">0.79607843</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.90588235</span><span class="p">,</span> <span class="mf">0.54117647</span><span class="p">,</span> <span class="mf">0.76470588</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.65098039</span><span class="p">,</span> <span class="mf">0.84705882</span><span class="p">,</span> <span class="mf">0.32941176</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.85098039</span><span class="p">,</span> <span class="mf">0.18431373</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.89803922</span><span class="p">,</span> <span class="mf">0.76862745</span><span class="p">,</span> <span class="mf">0.58039216</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.70196078</span><span class="p">,</span> <span class="mf">0.70196078</span><span class="p">,</span> <span class="mf">0.70196078</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.86</span>      <span class="p">,</span> <span class="mf">0.3712</span>    <span class="p">,</span> <span class="mf">0.34</span>      <span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.8288</span>    <span class="p">,</span> <span class="mf">0.86</span>      <span class="p">,</span> <span class="mf">0.34</span>      <span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.34</span>      <span class="p">,</span> <span class="mf">0.86</span>      <span class="p">,</span> <span class="mf">0.3712</span>    <span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.34</span>      <span class="p">,</span> <span class="mf">0.8288</span>    <span class="p">,</span> <span class="mf">0.86</span>      <span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.3712</span>    <span class="p">,</span> <span class="mf">0.34</span>      <span class="p">,</span> <span class="mf">0.86</span>      <span class="p">,</span> <span class="mf">1.</span>        <span class="p">],</span>
           <span class="p">[</span><span class="mf">0.86</span>      <span class="p">,</span> <span class="mf">0.34</span>      <span class="p">,</span> <span class="mf">0.8288</span>    <span class="p">,</span> <span class="mf">1.</span>        <span class="p">]])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#</span><span class="si">%02x%02x%02x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span> <span class="k">for</span> <span class="n">rgb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_rgb</span><span class="p">]</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;bind&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;fusion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;enzymatic_mol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;enzymatic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;absorption&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;conversion_mol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;conversion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;fission&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;production&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="s1">&#39;decay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rocket&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;crest&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Reactions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cubehelix&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Bonds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;icefire&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Blues&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mako&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;ODF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;flare&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Virial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Virial Tensor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cubehelix&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rocket&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Torque&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Orientation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Spectral&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;icefire&quot;</span></div>
        
        
<div class="viewcode-block" id="Evaluation.load_file"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.load_file">[docs]</a>    <span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads an hdf5 file and extracts simulation properties such as temperature and simulation box size.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_name : `string`</span>
<span class="sd">            Name of the hdf5 file.</span>
<span class="sd">        path : `string`</span>
<span class="sd">            self.path is set to this directory. By default, self.path = Path(os.getcwd()) / &#39;Files&#39;. Default = None.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;.h5&#39;</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
            
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s1">&#39;Files/hdf5&#39;</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s1">&#39;Figures&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;Figures&#39;</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span><span class="p">)</span> 
            <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
                <span class="c1"># directory already exists</span>
                <span class="k">pass</span>
            
        <span class="n">hdf</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">][</span><span class="n">measure</span><span class="p">][()]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">][()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">box_lengths</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;box_lengths&#39;</span><span class="p">][()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;dt&#39;</span><span class="p">][()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;eta&#39;</span><span class="p">][()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kbt</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;kbt&#39;</span><span class="p">][()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsteps</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Setup&#39;</span><span class="p">][</span><span class="s1">&#39;nsteps&#39;</span><span class="p">][()]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">read_molecule_data</span><span class="p">()</span>
        
        <span class="n">hdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="Evaluation.read_molecule_data"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.read_molecule_data">[docs]</a>    <span class="k">def</span> <span class="nf">read_molecule_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads molecule data from the hdf5 file (mobility tensor, bead position and radii, etc.)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">hdf</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">]:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;pos&#39;</span><span class="p">][()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;radii&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;radii&#39;</span><span class="p">][()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;volume&#39;</span><span class="p">][()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;mu_rb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;mu_rb&#39;</span><span class="p">][()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Molecules</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;mu_tb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;mu_tb&#39;</span><span class="p">][()]</span>
            
        <span class="n">hdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
        
    <span class="c1">#%%</span>
    
<div class="viewcode-block" id="Evaluation.load_hdf"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.load_hdf">[docs]</a>    <span class="k">def</span> <span class="nf">load_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads any hdf5 file from self.path directory.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hdf</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Evaluation.close_hdf"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.close_hdf">[docs]</a>    <span class="k">def</span> <span class="nf">close_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Closes the hdf5 file.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
        
        
    <span class="c1">#%%</span>
    
<div class="viewcode-block" id="Evaluation.MSD"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.MSD">[docs]</a>    <span class="k">def</span> <span class="nf">MSD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">molecule</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the Mean Squared Distance (MSD) from the molecule positions and from theory.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time_interval : `int64`</span>
<span class="sd">            The time step until which the molecule positions are sampled for the MSD calculation. Note: Currently sampling always starts at time step 0.</span>
<span class="sd">        stride : `int64`</span>
<span class="sd">            Stride with which the molecule positions are sampled.</span>
<span class="sd">        Simulation : `object`</span>
<span class="sd">            Instance of the Simulation class.</span>
<span class="sd">        molecule : `string`</span>
<span class="sd">            Name of the molecule type.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_observable</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;stepwise&#39;</span><span class="p">,</span> <span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">steps</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">)</span>
        
        <span class="n">position_trace</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stepwise&#39;</span><span class="p">][</span><span class="s1">&#39;Position&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">]:</span>
            <span class="n">position_trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stepwise&#39;</span><span class="p">][</span><span class="s1">&#39;Position&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="n">step</span><span class="p">])</span>
            
        <span class="n">position_trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position_trace</span><span class="p">)</span>
        <span class="n">pos_stride</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">][</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span> 
        <span class="n">Delta_t</span> <span class="o">=</span> <span class="n">pos_stride</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">MSD_data</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">MSD</span><span class="p">(</span><span class="n">position_trace</span><span class="p">,</span> <span class="n">Delta_t</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span></div>
        
        

<div class="viewcode-block" id="Evaluation.plot_MSD"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.plot_MSD">[docs]</a>    <span class="k">def</span> <span class="nf">plot_MSD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the molecules&#39; Mean Squared Distance (MSD).</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Simulation : `object`</span>
<span class="sd">            Instance of the Simulation class.</span>
<span class="sd">        molecule : `string`</span>
<span class="sd">            Name of the molecule type.</span>
<span class="sd">        save_fig : `boolean`</span>
<span class="sd">            Default = False</span>
<span class="sd">        fig_name : `string`</span>
<span class="sd">            Default = None</span>
<span class="sd">        fig_path : `string`</span>
<span class="sd">             Default = None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
        
        <span class="n">MSD_x</span><span class="p">,</span> <span class="n">MSD_y</span><span class="p">,</span> <span class="n">MSD_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MSD_data</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span>
        
        <span class="n">D_tt</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span><span class="o">.</span><span class="n">D_tt</span>
        <span class="n">D_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">D_tt</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">MSD_x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">MSD_y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">MSD_z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">D_trans</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">time_MSD</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Theory&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">fontLgd</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">time_unit</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MSD&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">save_fig</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">molecule</span>
            <span class="k">if</span> <span class="n">fig_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_path</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">fig_path</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">fig_name</span><span class="o">+</span><span class="s1">&#39;_MSD.png&#39;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></div>
            

    <span class="c1">#%%</span>

<div class="viewcode-block" id="Evaluation.P2"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.P2">[docs]</a>    <span class="k">def</span> <span class="nf">P2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">theory_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">Delta_t</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the rotational time correlation function P2 from the molecule orientations and from theory.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time_interval : `int64`</span>
<span class="sd">            The time step until which the molecule positions are sampled for the MSD calculation. Note: Currently sampling always starts at time step 0.</span>
<span class="sd">        stride : `int64`</span>
<span class="sd">            Stride with which the molecule positions are sampled.</span>
<span class="sd">        Simulation : `object`</span>
<span class="sd">            Instance of the Simulation class.</span>
<span class="sd">        molecule : `string`</span>
<span class="sd">            Name of the molecule type.</span>
<span class="sd">        theory_only : `boolean`</span>
<span class="sd">            If set to True, only the theoretical values for P2 are calculated. Default = False.</span>
<span class="sd">        Delta_t : `float64`</span>
<span class="sd">            Time step.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_observable</span><span class="p">(</span><span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;stepwise&#39;</span><span class="p">,</span> <span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">steps</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">)</span>
        
        <span class="n">D_rr</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span><span class="o">.</span><span class="n">D_rr</span>
        
        <span class="n">orientation_trace</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stepwise&#39;</span><span class="p">][</span><span class="s1">&#39;Orientation&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">]:</span>
            <span class="n">orientation_trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stepwise&#39;</span><span class="p">][</span><span class="s1">&#39;Orientation&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="n">step</span><span class="p">])</span>
            
        <span class="n">orientation_trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">orientation_trace</span><span class="p">)</span>
        <span class="n">orientation_stride</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">][</span><span class="s1">&#39;Orientation&#39;</span><span class="p">]</span> 
        <span class="n">Delta_t</span> <span class="o">=</span> <span class="n">orientation_stride</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="n">result</span> <span class="o">=</span>  <span class="n">diff</span><span class="o">.</span><span class="n">P2</span><span class="p">(</span><span class="n">orientation_trace</span><span class="p">,</span> <span class="n">Delta_t</span><span class="p">,</span> <span class="n">D_rr</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">theory_only</span> <span class="o">=</span> <span class="n">theory_only</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">theory_only</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P2_data</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2_t</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
            <span class="n">P2_1_t</span><span class="p">,</span> <span class="n">P2_2_t</span><span class="p">,</span> <span class="n">P2_3_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2_t</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span>
            <span class="n">P2_1</span><span class="p">,</span> <span class="n">P2_2</span><span class="p">,</span> <span class="n">P2_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2_data</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P2_t</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
            <span class="n">P2_1_t</span><span class="p">,</span> <span class="n">P2_2_t</span><span class="p">,</span> <span class="n">P2_3_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2_t</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span></div>
        
    
<div class="viewcode-block" id="Evaluation.plot_P2"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.plot_P2">[docs]</a>    <span class="k">def</span> <span class="nf">plot_P2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">theory_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limits</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the rotational time correlation function P2.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Simulation : `object`</span>
<span class="sd">            Instance of the Simulation class.</span>
<span class="sd">        molecule : `string`</span>
<span class="sd">            Name of the molecule type.</span>
<span class="sd">        theory_only : `boolean`</span>
<span class="sd">            If set to True, only the theoretical values for P2 are calculated. Default = False.</span>
<span class="sd">        save_fig : `boolean`</span>
<span class="sd">            Default = False</span>
<span class="sd">        fig_name : `string`</span>
<span class="sd">            Default = None</span>
<span class="sd">        fig_path : `string`</span>
<span class="sd">             Default = None</span>
<span class="sd">        limits : `float64[2,2]`</span>
<span class="sd">            x- and y-axis limits. Default = None.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
        
        <span class="n">P2_1_t</span><span class="p">,</span> <span class="n">P2_2_t</span><span class="p">,</span> <span class="n">P2_3_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2_t</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span>
        <span class="n">P2_1</span><span class="p">,</span> <span class="n">P2_2</span><span class="p">,</span> <span class="n">P2_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2_data</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span>
        
        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">P2_1_t</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Theory&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">P2_2_t</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">P2_3_t</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">theory_only</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">P2_1</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">P2_2</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_P2</span><span class="p">[</span><span class="n">molecule</span><span class="p">],</span> <span class="n">P2_3</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">fontLgd</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">time_unit</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\langle P_{\hat</span><span class="si">{u}</span><span class="s1">}(t) \rangle$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
        
        <span class="k">if</span> <span class="n">save_fig</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">molecule</span>
            <span class="k">if</span> <span class="n">fig_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_path</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">fig_path</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">fig_name</span><span class="o">+</span><span class="s1">&#39;_RotDiff_Pu.png&#39;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></div>
                
    
    <span class="c1">#%%</span>
    
    <span class="c1"># def plot_observable(self, measure, molecules = &#39;All&#39;, step = 0, save_fig = False, fig_name = None , fig_path = None, binned = False):</span>
    
    <span class="c1">#     plot_observable(self, measure, molecules = molecules, step = step, save_fig = save_fig, fig_name = fig_name , fig_path = fig_path, binned = binned)</span>
        
        
<div class="viewcode-block" id="Evaluation.plot_rdf"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.plot_rdf">[docs]</a>    <span class="k">def</span> <span class="nf">plot_rdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_pairs</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_name</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the radial distribution function (RDF) from the hdf5 file.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mol_pairs : `nested list of strings`</span>
<span class="sd">            Molecule pairs for which the rdf is plotted.</span>
<span class="sd">        steps : `int64[1]`</span>
<span class="sd">            Time steps. Default = [0]</span>
<span class="sd">        theory_only : `boolean`</span>
<span class="sd">            If set to True, only the theoretical values for P2 are calculated. Default = False.</span>
<span class="sd">        save_fig : `boolean`</span>
<span class="sd">            Default = False</span>
<span class="sd">        fig_name : `string`</span>
<span class="sd">            Default = None</span>
<span class="sd">        fig_path : `string`</span>
<span class="sd">             Default = None</span>
<span class="sd">        average : `boolean`</span>
<span class="sd">            Average over rdfs at different points in time if more than one time step is given in parameter &quot;steps&quot;. Default = False</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple(fig, ax)</span>
<span class="sd">            figure and corresponding axes object.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
        
        <span class="n">hdf</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">average</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            
        <span class="k">for</span> <span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span> <span class="ow">in</span> <span class="n">mol_pairs</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">steps</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                <span class="n">steps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">][</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">][</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">steps_temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
                    <span class="c1"># digits = int(math.log10(self.nsteps))+1</span>
                    <span class="n">step_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s1">0</span><span class="si">{</span><span class="n">digits</span><span class="si">}}</span><span class="s1">&#39;</span>
                    <span class="n">steps_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step_id</span><span class="p">)</span>
                <span class="n">steps</span> <span class="o">=</span> <span class="n">steps_temp</span>
            
            <span class="n">rdf_bins</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">][</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;rdf_bins&#39;</span><span class="p">]</span>
            <span class="n">rdf_cutoff</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">][</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;rdf_cutoff&#39;</span><span class="p">]</span>
            <span class="n">dr_rdf</span> <span class="o">=</span> <span class="n">rdf_cutoff</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">rdf_bins</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rdf_cutoff</span><span class="p">,</span> <span class="n">rdf_bins</span><span class="p">)</span><span class="o">+</span><span class="n">dr_rdf</span><span class="o">/</span><span class="mi">2</span>
            
            <span class="n">time_steps</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
        
                <span class="k">if</span> <span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rdf</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rdf</span><span class="p">[</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    
                <span class="n">time_step</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">][</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">][</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;time step&#39;</span><span class="p">])</span> <span class="c1"># Need to use string, because for some reason seaborn doesnt handle numerical values for the hue value as expected!</span>
                <span class="n">time_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_step</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">time_step</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rdf</span><span class="p">[</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rdf</span><span class="p">[</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">][</span><span class="n">time_step</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="s1">&#39;RDF&#39;</span><span class="p">][</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">][</span><span class="n">step</span><span class="p">][()]</span>
                
                
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rdf</span><span class="p">[</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">])[</span><span class="n">time_steps</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="n">dfm</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;time (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">&#39;g(r)&#39;</span><span class="p">)</span>
            
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">average</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;g(r)&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dfm</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;g(r)&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;time (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dfm</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s1">&#39;rocket&#39;</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="s1">&#39;sd&#39;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">average</span> <span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                <span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;time (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span> <span class="n">prop</span><span class="o">=</span><span class="n">fontLgd</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;r in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g(r)&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">save_fig</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="n">fig_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">fig_name</span><span class="o">+</span><span class="s1">&#39;_RDF_&#39;</span><span class="o">+</span><span class="n">mol1</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">mol2</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>

      
        <span class="n">hdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>
        
    <span class="c1">#%%</span>
    
<div class="viewcode-block" id="Evaluation.read_observable"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.read_observable">[docs]</a>    <span class="k">def</span> <span class="nf">read_observable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">sampling</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">molecules</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">educts</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">Reaction_Type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">file_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads an observable / measure from the hdf5 file.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        measure : `string`</span>
<span class="sd">            observable / measure which to read from the hdf5 file.</span>
<span class="sd">        sampling : stepwise&#39; or &#39;binned&#39; or None</span>
<span class="sd">            Sampling method used. If None, the sampling method is chosen automatically based on the measure type. Default = None.</span>
<span class="sd">        molecules : `list of strings`</span>
<span class="sd">            List of molecule types for which to read the observable data. If set to &#39;All&#39;, all molecules found in the hdf5 file are loaded. Default = &#39;All&#39;.</span>
<span class="sd">        educts : `list of strings`</span>
<span class="sd">            List of reaction educts for which to read the reactions data. If set to &#39;All&#39;, all reactions found in the hdf5 file are loaded. Default = &#39;All&#39;.</span>
<span class="sd">        Reaction_Type : &#39;bind&#39;, &#39;enzymatic&#39;, &#39;conversion&#39;, &#39;conversion_rb&#39;, &#39;decay_rb&#39;, &#39;production_rb&#39;, &#39;release&#39;, &#39;fusion&#39;, &#39;enzymatic_rb&#39;</span>
<span class="sd">            Type of the reaction whose data is read from the hdf5 file.</span>
<span class="sd">        steps : `int64[:]` or `All`</span>
<span class="sd">            Time steps at which to read the observable data. Default = `All`</span>
<span class="sd">        file_path : `string`</span>
<span class="sd">            File path. Default = None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        

        <span class="n">hdf</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">track_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">sampling</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Torque&#39;</span><span class="p">,</span> <span class="s1">&#39;Force&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial Tensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonds&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">]:</span>
                <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;stepwise&#39;</span>
            <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Reactions&#39;</span><span class="p">:</span>
                <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;binned&#39;</span>
            
        <span class="n">stride</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="s1">&#39;stride&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="n">stride</span>
        <span class="k">elif</span> <span class="n">measure</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="n">stride</span>
            
        <span class="k">if</span> <span class="n">sampling</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">elif</span> <span class="n">measure</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    
        <span class="k">if</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Torque&#39;</span><span class="p">,</span> <span class="s1">&#39;Force&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial&#39;</span><span class="p">,</span> <span class="s1">&#39;Virtial Tensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">]:</span>
            
            <span class="k">if</span> <span class="n">molecules</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                <span class="n">molecules</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                
            <span class="k">if</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Torque&#39;</span><span class="p">,</span> <span class="s1">&#39;Force&#39;</span><span class="p">]:</span>
                <span class="n">timesteps_seperated</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># For properties such as position, the data for each time step is saved seperately in an array.</span>
                <span class="k">if</span> <span class="n">steps</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                    <span class="n">steps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">steps_temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
                        <span class="c1"># digits = int(math.log10(self.nsteps))+1</span>
                        <span class="n">step_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s1">0</span><span class="si">{</span><span class="n">digits</span><span class="si">}}</span><span class="s1">&#39;</span>
                        <span class="n">steps_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step_id</span><span class="p">)</span>
                    <span class="n">steps</span> <span class="o">=</span> <span class="n">steps_temp</span>
                    
            <span class="k">elif</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Virial&#39;</span><span class="p">,</span> <span class="s1">&#39;Virtial Tensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">]:</span>
                <span class="n">timesteps_seperated</span> <span class="o">=</span> <span class="kc">False</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">stride</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
            
            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">:</span>
                
                <span class="k">if</span> <span class="n">timesteps_seperated</span><span class="p">:</span>
                    
                    <span class="k">if</span> <span class="n">molecule</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecule</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        
                    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
                        <span class="c1"># time_step = hdf[sampling][measure][molecule][step].attrs[&#39;time step&#39;]</span>
                        <span class="c1"># if time_step not in self.Observables[sampling][measure][molecule]:</span>
                        <span class="k">if</span> <span class="n">step</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="n">step</span><span class="p">][()]</span>
                       
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">molecule</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecule</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecule</span><span class="p">][()]</span>
            
                                                                                                                   
        <span class="k">elif</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Volume&#39;</span><span class="p">]:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">stride</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">measure</span><span class="p">]))</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">measure</span><span class="p">][()]</span>
                   
        <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Reactions&#39;</span><span class="p">:</span>
        
            <span class="k">if</span> <span class="n">Reaction_Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bind&#39;</span><span class="p">,</span> <span class="s1">&#39;enzymatic&#39;</span><span class="p">,</span> <span class="s1">&#39;conversion&#39;</span><span class="p">,</span> <span class="s1">&#39;conversion_rb&#39;</span><span class="p">,</span> <span class="s1">&#39;decay_rb&#39;</span><span class="p">,</span> <span class="s1">&#39;production_rb&#39;</span><span class="p">,</span> <span class="s1">&#39;release&#39;</span><span class="p">]:</span>
            
                <span class="k">for</span> <span class="n">educt</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">reaction_type</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">educt</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        
                        <span class="k">if</span> <span class="n">reaction_type</span> <span class="o">==</span> <span class="n">Reaction_Type</span><span class="p">:</span>
                            
                            <span class="k">if</span> <span class="n">reaction_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                                
                            <span class="k">if</span> <span class="n">educt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">]:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                            
                            <span class="k">for</span> <span class="n">reaction_path</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

                                <span class="k">if</span> <span class="n">reaction_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">]:</span>
                                    
                                    <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">Reaction_Type</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">reaction_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">reaction_path</span><span class="p">][()]</span>
                                    
            <span class="k">elif</span> <span class="n">Reaction_Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fusion&#39;</span><span class="p">,</span> <span class="s1">&#39;enzymatic_rb&#39;</span><span class="p">]:</span>

                <span class="k">for</span> <span class="n">particle_educt</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">reaction_type</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        
                        <span class="k">if</span> <span class="n">reaction_type</span> <span class="o">==</span> <span class="n">Reaction_Type</span><span class="p">:</span>
                            
                            <span class="k">if</span> <span class="n">reaction_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                            
                            <span class="k">for</span> <span class="n">educt</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                
                                <span class="k">if</span> <span class="n">educt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">]:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                                
                                <span class="k">if</span> <span class="n">particle_educt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">]:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                                    
                                <span class="k">for</span> <span class="n">reaction_path</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    
                                    <span class="k">if</span> <span class="n">reaction_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">]:</span>
                                        
                                        <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">Reaction_Type</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">][</span><span class="n">reaction_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Reactions&#39;</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">][</span><span class="n">reaction_type</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">reaction_path</span><span class="p">][()]</span>                
                
        
        <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Bonds&#39;</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">bond_pair</span> <span class="ow">in</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Bonds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">bond_pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdf</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Bonds&#39;</span><span class="p">][</span><span class="n">bond_pair</span><span class="p">][()]</span>            
            
                                    
        <span class="n">hdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
    
    <span class="c1">#%%</span>
    
<div class="viewcode-block" id="Evaluation.plot_observable"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.plot_observable">[docs]</a>    <span class="k">def</span> <span class="nf">plot_observable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">molecules</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">Reaction_Type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">educt</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bond_pairs</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">particle_educt</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_name</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sampling</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">formats</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;png&#39;</span><span class="p">],</span> <span class="n">show</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots an observable / measure found in the hdf5 file.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        measure : `string`</span>
<span class="sd">            observable / measure which to read from the hdf5 file.</span>
<span class="sd">        sampling : stepwise&#39; or &#39;binned&#39; or None</span>
<span class="sd">            Sampling method used. If None, the sampling method is chosen automatically based on the measure type. Default = None.</span>
<span class="sd">        molecules : `list of strings`</span>
<span class="sd">            List of molecule types for which to read the observable data. If set to &#39;All&#39;, all molecules found in the hdf5 file are loaded. Default = &#39;All&#39;.</span>
<span class="sd">        educt : `list of strings`</span>
<span class="sd">            List of reaction educts for which to read the reactions data. If set to &#39;All&#39;, all reactions found in the hdf5 file are loaded. Default = &#39;All&#39;.</span>
<span class="sd">        bond_pairs : `list of strings`</span>
<span class="sd">            List of bond pair types for which to read particle bond data. If set to &#39;All&#39;, all bonds found in the hdf5 file are loaded. Default = &#39;All&#39;.</span>
<span class="sd">        particle_educts : `list of strings`</span>
<span class="sd">            List of particle reaction educts for which to read the reactions data. If set to &#39;All&#39;, all particle reactions found in the hdf5 file are loaded. Default = &#39;All&#39;.</span>
<span class="sd">        Reaction_Type : &#39;bind&#39;, &#39;enzymatic&#39;, &#39;conversion&#39;, &#39;conversion_rb&#39;, &#39;decay_rb&#39;, &#39;production_rb&#39;, &#39;release&#39;, &#39;fusion&#39;, &#39;enzymatic_rb&#39;</span>
<span class="sd">            Type of the reaction whose data is read from the hdf5 file.</span>
<span class="sd">        step : `int64`</span>
<span class="sd">            Time step at which to read the observable data. Default = 0</span>
<span class="sd">        save_fig : `boolean`</span>
<span class="sd">            Default = False</span>
<span class="sd">        fig_name : `string`</span>
<span class="sd">            Default = None</span>
<span class="sd">        fig_path : `string`</span>
<span class="sd">             Default = None</span>
<span class="sd">        sampling : stepwise&#39; or &#39;binned&#39; or None</span>
<span class="sd">            Sampling method used. If None, the sampling method is chosen automatically based on the measure type. Default = None.</span>
<span class="sd">        formats : `list of strings`</span>
<span class="sd">            File formats in which figures are saved. Default = [&#39;png&#39;]</span>
<span class="sd">        show : `boolean`</span>
<span class="sd">            If True, figures are shown directly after they have been plotted. Otherwise figures are not shown (make sure to set save_fig = True). Default = True.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple(fig, ax)</span>
<span class="sd">            figure and corresponding axes object.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Measures = [&#39;Position&#39;, &#39;Energy&#39;, &#39;Pressure&#39;, &#39;Volume&#39;, &#39;Virial&#39;, &#39;Virial Tensor&#39;, &#39;Number&#39;, &#39;Orientation&#39;, &#39;Bonds&#39;, &#39;Reactions&#39;, &#39;Force&#39;, &#39;Torque&#39;, &#39;RDF&#39;]</span>
        
        <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">sampling</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Torque&#39;</span><span class="p">,</span> <span class="s1">&#39;Force&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial Tensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonds&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">]:</span>
                <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;stepwise&#39;</span>
            <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Reactions&#39;</span><span class="p">:</span>
                <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;binned&#39;</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">read_observable</span><span class="p">(</span><span class="n">measure</span><span class="p">,</span> <span class="n">sampling</span> <span class="o">=</span> <span class="n">sampling</span><span class="p">,</span> <span class="n">molecules</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">,</span> <span class="n">Reaction_Type</span> <span class="o">=</span> <span class="n">Reaction_Type</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="n">step</span><span class="p">])</span>
        
        <span class="n">stride</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="s1">&#39;stride&#39;</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">molecules</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
            <span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">molecule</span> <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">]</span> <span class="k">if</span> <span class="n">molecule</span> <span class="o">!=</span> <span class="s1">&#39;time&#39;</span><span class="p">]</span>
                
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;Virial&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">]:</span>
             
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">])[[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">molecules</span><span class="p">]</span>
            <span class="n">dfm</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;Molecules&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="n">measure</span><span class="p">)</span>
            
            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">measure</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Molecules&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dfm</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="n">measure</span><span class="p">])</span>
    
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]))</span>
            
            <span class="n">legend</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Molecules&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">fontLgd</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">,</span> <span class="s1">&#39;Torque&#39;</span><span class="p">,</span> <span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">]:</span>
            
            <span class="n">sampling</span> <span class="o">=</span> <span class="s1">&#39;stepwise&#39;</span>
            
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;time point: </span><span class="si">{0:1.1f}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="o">*</span><span class="n">stride</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
            
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">step</span><span class="p">])</span>
            <span class="c1"># df.columns = [&#39;x&#39;, &#39;y&#39;, &#39;z&#39;]</span>
            
            <span class="k">if</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;q0&#39;</span><span class="p">,</span><span class="s1">&#39;q1&#39;</span><span class="p">,</span><span class="s1">&#39;q2&#39;</span><span class="p">,</span><span class="s1">&#39;q3&#39;</span><span class="p">]],</span> <span class="n">palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="n">measure</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]],</span> <span class="n">palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="n">measure</span><span class="p">])</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Molecule: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">molecules</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Molecules&#39;</span><span class="p">)</span>
                
            <span class="n">legend</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dimension&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">fontLgd</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">measure</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Volume&#39;</span><span class="p">]:</span>
            
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">])[[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">]]</span>
            
            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">measure</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="n">measure</span><span class="p">])</span>
    
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]))</span>            
            
        <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Reactions&#39;</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">Reaction_Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bind&#39;</span><span class="p">,</span> <span class="s1">&#39;enzymatic&#39;</span><span class="p">,</span> <span class="s1">&#39;conversion&#39;</span><span class="p">,</span> <span class="s1">&#39;conversion_rb&#39;</span><span class="p">,</span> <span class="s1">&#39;decay_rb&#39;</span><span class="p">,</span> <span class="s1">&#39;production_rb&#39;</span><span class="p">,</span> <span class="s1">&#39;release&#39;</span><span class="p">]:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">Reaction_Type</span><span class="p">][</span><span class="n">educt</span><span class="p">])</span>
                
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">educt</span><span class="o">+</span><span class="s1">&#39; | &#39;</span><span class="o">+</span><span class="n">Reaction_Type</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="n">Reaction_Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fusion&#39;</span><span class="p">,</span> <span class="s1">&#39;enzymatic_rb&#39;</span><span class="p">]:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">][</span><span class="n">Reaction_Type</span><span class="p">][</span><span class="n">educt</span><span class="p">][</span><span class="n">particle_educt</span><span class="p">])</span>
                
                <span class="n">educt_1</span> <span class="p">,</span> <span class="n">educt_2</span> <span class="o">=</span> <span class="n">educt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
                <span class="n">particle_educt_1</span> <span class="p">,</span> <span class="n">particle_educt_2</span> <span class="o">=</span> <span class="n">particle_educt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">educt_1</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">particle_educt_1</span><span class="si">}</span><span class="s1">)+</span><span class="si">{</span><span class="n">educt_2</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">particle_educt_2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="o">+</span><span class="s1">&#39; | &#39;</span><span class="o">+</span><span class="n">Reaction_Type</span><span class="p">)</span>
                
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">stride</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsteps</span><span class="o">/</span><span class="n">stride</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">dfm</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;paths&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="n">measure</span><span class="p">)</span>
            
            <span class="c1"># g = sns.lineplot(x=&quot;time&quot;, data = df, palette = self.color_pallete[measure])</span>
            
            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">measure</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;paths&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dfm</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="n">measure</span><span class="p">],</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            
            
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]))</span>
            
            
        <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Bonds&#39;</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">bond_pairs</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                <span class="n">bond_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="s1">&#39;Bonds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observables</span><span class="p">[</span><span class="n">sampling</span><span class="p">][</span><span class="n">measure</span><span class="p">])[</span><span class="n">bond_pairs</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">stride</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsteps</span><span class="o">/</span><span class="n">stride</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">dfm</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;bond pairs&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="n">measure</span><span class="p">)</span>
            
            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">measure</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bond pairs&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dfm</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="p">[</span><span class="n">measure</span><span class="p">])</span>
    
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]))</span>
            
            <span class="n">legend</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;bond pairs&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">fontLgd</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">)</span>            
            
        
        <span class="k">if</span> <span class="n">sampling</span> <span class="o">==</span> <span class="s1">&#39;stepwise&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">measure</span><span class="o">+</span><span class="s1">&#39; in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">measure</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="n">sampling</span> <span class="o">==</span> <span class="s1">&#39;binned&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">measure</span><span class="o">+</span><span class="s1">&#39; in </span><span class="si">{0}</span><span class="s1">/(</span><span class="si">{1}{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">measure</span><span class="p">],</span> <span class="n">stride</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]))</span>
        
        <span class="k">if</span> <span class="n">save_fig</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">fig_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span>
            <span class="k">for</span> <span class="n">frmt</span> <span class="ow">in</span> <span class="n">formats</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;Reactions&#39;</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">fig_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">measure</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">Reaction_Type</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;.</span><span class="si">{</span><span class="n">frmt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">fig_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">measure</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;.</span><span class="si">{</span><span class="n">frmt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>
    
    <span class="c1">#%%</span>
            
<div class="viewcode-block" id="Evaluation.plot_reactions_graph"><a class="viewcode-back" href="../../../Developers/Developer%20API/evaluation/evaluation_util.html#pyrid.evaluation.evaluation_util.Evaluation.plot_reactions_graph">[docs]</a>    <span class="k">def</span> <span class="nf">plot_reactions_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">graph_type</span> <span class="o">=</span> <span class="s1">&#39;Bimolecular&#39;</span><span class="p">,</span> <span class="n">graph_subtype</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots a reactions graph using the pyvis library.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Simulation : `object`</span>
<span class="sd">            Instance of Simulation class</span>
<span class="sd">        graph_type : &#39;Bimolecular&#39;, &#39;Biparticle&#39;, &#39;Unimolecular&#39;, &#39;Interactions&#39;</span>
<span class="sd">            Reaction graph type. Default = &#39;Bimolecular&#39;</span>
<span class="sd">        graph_subtype : &#39;pair relations&#39;, &#39;product relations&#39;</span>
<span class="sd">            Reaction graph subtype. Default = &#39;product_relations&#39;.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># np.dtype([(&#39;defined&#39;, bool), (&#39;bond&#39;, bool), (&#39;id&#39;, np.int64), (&#39;enzyme&#39;, np.int64), (&#39;rate&#39;, np.float64), (&#39;radius&#39;, np.float64), (&#39;cutoff&#39;, np.float64), (&#39;type&#39;, &#39;U20&#39;), (&#39;type_id&#39;, np.int64), (&#39;type_BP_BM&#39;, &#39;U2&#39;),],  align=True)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bimolecular&#39;</span><span class="p">,</span> <span class="s1">&#39;Biparticle&#39;</span><span class="p">,</span> <span class="s1">&#39;Unimolecular&#39;</span><span class="p">,</span> <span class="s1">&#39;Interactions&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_subtypes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pair relations&#39;</span><span class="p">,</span> <span class="s1">&#39;product relations&#39;</span><span class="p">]</span>
        
        <span class="n">Nodes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">N_particles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">)</span>
        
        <span class="n">Edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">Product_Node_id</span> <span class="o">=</span> <span class="p">{}</span>
        
        
        <span class="k">if</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;Interactions&#39;</span><span class="p">:</span>
 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="o">-</span><span class="n">i</span><span class="p">):</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_particles</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">j</span>
                    
                    <span class="k">if</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;defined&#39;</span><span class="p">]:</span>
                        
                        <span class="n">reaction_id</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
                        <span class="n">bond</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;bond&#39;</span><span class="p">]</span>
                        <span class="n">rate</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">rate</span>
                        <span class="n">radius</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">radius</span>
                        <span class="n">reaction_educt_type</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">reaction_educt_type</span>
                        <span class="n">educts</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">educts</span>
                                
                        <span class="k">if</span> <span class="n">bond</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                            
                            <span class="n">educts_id_i</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="n">educts_id_j</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="n">pname_i</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">particle_id_to_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">pname_j</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">particle_id_to_name</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            
                            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">:</span>
                                   
                                <span class="k">if</span> <span class="n">pname_i</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span><span class="o">.</span><span class="n">types</span><span class="p">:</span>
                                    <span class="n">educts_id_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span>
                                    
                                <span class="k">if</span> <span class="n">pname_j</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span><span class="o">.</span><span class="n">types</span><span class="p">:</span>
                                    <span class="n">educts_id_j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_types</span><span class="p">[</span><span class="n">molecule</span><span class="p">]</span><span class="o">.</span><span class="n">type_id</span><span class="p">)</span>

                            <span class="n">educt_pairs</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">ei</span> <span class="ow">in</span> <span class="n">educts_id_i</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">ej</span> <span class="ow">in</span> <span class="n">educts_id_j</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="n">ei</span><span class="p">,</span><span class="n">ej</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">educt_pairs</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ej</span><span class="p">,</span><span class="n">ei</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">educt_pairs</span><span class="p">:</span>
                                        <span class="n">educt_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ei</span><span class="p">,</span><span class="n">ej</span><span class="p">))</span>
                                        
                            <span class="k">for</span> <span class="n">educts</span> <span class="ow">in</span> <span class="n">educt_pairs</span><span class="p">:</span>
                                
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                                <span class="n">i_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_name</span><span class="p">)</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                
                                <span class="k">if</span> <span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span> <span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                    <span class="n">educt_1_idx</span> <span class="o">=</span> <span class="mi">96000</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">educt_1_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                    
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">educt_1_idx</span><span class="p">)</span>
                                <span class="n">j_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j_name</span><span class="p">)</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                
                                <span class="n">path</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                    
                                <span class="n">rate</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span>
                                <span class="n">reaction_type</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                                
                                <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">educt_1_idx</span><span class="p">))</span>
                                <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>
                                <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1">,</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">radius</span><span class="p">))</span>
                                <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="n">reaction_type</span><span class="p">])</span>
        
        
        <span class="k">if</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;Unimolecular&#39;</span><span class="p">:</span>
            
            <span class="n">node_idx</span> <span class="o">=</span> <span class="mi">96000</span>
            <span class="k">for</span> <span class="n">reaction_id</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">:</span>
                <span class="n">reaction_educt_type</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">reaction_educt_type</span>
                <span class="n">bimol</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">bimol</span>
                
                <span class="k">if</span> <span class="n">bimol</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">reaction_educt_type</span> <span class="o">==</span> <span class="s1">&#39;Molecule&#39;</span><span class="p">:</span>
                    
                    <span class="n">educts</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">educts</span>
                    
                    <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="n">i_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_name</span><span class="p">)</span>
                    <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>   
                    
                    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
                        
                        <span class="n">n_products</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;n_products&#39;</span><span class="p">]</span>
                        <span class="n">product_ids</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;products_ids&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">n_products</span><span class="p">]</span>
                        <span class="n">rate</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span>
                        <span class="n">reaction_type</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                        
                        <span class="n">p_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                        <span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">product_ids</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">p_id</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span><span class="n">counts</span><span class="p">):</span>
                            <span class="n">p_name</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"></span><span class="si">{1}</span><span class="s1">+&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">p_id</span><span class="p">])</span>
                        <span class="n">p_name</span> <span class="o">=</span> <span class="n">p_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        
                        <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_idx</span><span class="p">)</span>
                        <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_name</span><span class="p">)</span>
                        <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">unique</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                    
                        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">node_idx</span><span class="p">))</span>
                        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>  
                        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rate</span><span class="p">))</span>           
                        <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="n">reaction_type</span><span class="p">])</span>
                        
                        <span class="n">node_idx</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">if</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;Bimolecular&#39;</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">graph_subtype</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">graph_subtype</span> <span class="o">=</span> <span class="s1">&#39;product_relations&#39;</span>
                
            <span class="k">if</span> <span class="n">graph_subtype</span> <span class="o">==</span> <span class="s1">&#39;educt_relations&#39;</span><span class="p">:</span>
                
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="o">-</span><span class="n">i</span><span class="p">):</span>
                        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_particles</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">j</span>
                        
                        <span class="k">if</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;defined&#39;</span><span class="p">]:</span>
                            
                            <span class="n">reaction_id</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
                            <span class="n">bond</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;bond&#39;</span><span class="p">]</span>
                            <span class="n">rate</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">rate</span>
                            <span class="n">radius</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">radius</span>
                            <span class="n">reaction_educt_type</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">reaction_educt_type</span>
                            <span class="n">educts</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">educts</span>
                            
                            <span class="k">if</span> <span class="n">reaction_educt_type</span> <span class="o">==</span> <span class="s1">&#39;Molecule&#39;</span><span class="p">:</span>
                                
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                                <span class="n">i_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_name</span><span class="p">)</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                
                                <span class="k">if</span> <span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                    <span class="n">educt_1_idx</span> <span class="o">=</span> <span class="mi">96000</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">educt_1_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                    
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">educt_1_idx</span><span class="p">)</span>
                                <span class="n">j_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j_name</span><span class="p">)</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                
                                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
                                    
                                    <span class="n">rate</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span>
                                    <span class="n">reaction_type</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                                    
                                    <span class="c1"># print(i_name, j_name)</span>
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">educt_1_idx</span><span class="p">))</span>
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1">,</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">radius</span><span class="p">))</span>
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="n">reaction_type</span><span class="p">])</span>

                                    
                                    
                <span class="c1"># print(Edges)</span>
                                    
            <span class="k">elif</span> <span class="n">graph_subtype</span> <span class="o">==</span> <span class="s1">&#39;product_relations&#39;</span><span class="p">:</span>
                
                <span class="n">prod_node_idx</span> <span class="o">=</span> <span class="mi">96000</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_particles</span><span class="o">-</span><span class="n">i</span><span class="p">):</span>
                        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_particles</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">j</span>
                        
                        <span class="k">if</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;defined&#39;</span><span class="p">]:</span>
                            
                            <span class="n">reaction_id</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reaction_args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
                            <span class="n">rate</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">rate</span>
                            <span class="n">radius</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">radius</span>
                            <span class="n">reaction_educt_type</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">reaction_educt_type</span>
                            <span class="n">educts</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">educts</span>
                            
                            <span class="k">if</span> <span class="n">reaction_educt_type</span> <span class="o">==</span> <span class="s1">&#39;Molecule&#39;</span><span class="p">:</span>
                                
                                <span class="n">node_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_pairing</span><span class="p">(</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">node_idx</span><span class="p">))</span>
                                <span class="n">i_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                                <span class="n">j_name</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_name</span> <span class="o">+</span> <span class="s1">&#39; + &#39;</span> <span class="o">+</span> <span class="n">j_name</span><span class="p">)</span>
                                <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">educts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                
                                <span class="n">p0</span> <span class="o">=</span> <span class="n">node_idx</span>
                                <span class="c1"># node_idx += 1</span>
                                
                                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">Reactions_Dict</span><span class="p">[</span><span class="n">reaction_id</span><span class="p">]</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
                                    
                                    <span class="n">n_products</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;n_products&#39;</span><span class="p">]</span>
                                    <span class="n">product_ids</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;products_ids&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">n_products</span><span class="p">]</span>
                                    <span class="n">rate</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span>
                                    <span class="n">reaction_type</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                                    
                                    <span class="n">p_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                                    <span class="k">for</span> <span class="n">p_id</span> <span class="ow">in</span> <span class="n">product_ids</span><span class="p">:</span>
                                        <span class="n">p_name</span> <span class="o">+=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">molecule_id_to_name</span><span class="p">[</span><span class="n">p_id</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;+&#39;</span>
                                    <span class="n">p_name</span> <span class="o">=</span> <span class="n">p_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                    
                                    <span class="k">if</span> <span class="n">p_name</span> <span class="ow">in</span> <span class="n">Product_Node_id</span><span class="p">:</span>
                                        <span class="n">p1</span> <span class="o">=</span> <span class="n">Product_Node_id</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">Product_Node_id</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prod_node_idx</span><span class="p">)</span>
                                        <span class="n">p1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prod_node_idx</span><span class="p">)</span>
                                        <span class="n">prod_node_idx</span> <span class="o">+=</span> <span class="mi">1</span>
                                    
                                    <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
                                    <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_name</span><span class="p">)</span>
                                    <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules_colors_hex</span><span class="p">[</span><span class="n">p_id</span><span class="o">%</span><span class="mi">24</span><span class="p">])</span>
                                    
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p0</span><span class="p">,</span><span class="n">p1</span><span class="p">))</span>
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span>  
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1">,</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">radius</span><span class="p">))</span>
                                    <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions_color</span><span class="p">[</span><span class="n">reaction_type</span><span class="p">])</span>
                                    
                                    
                                    
        <span class="c1"># print(Edges)</span>
                
                
                
        
        <span class="c1">#%%</span>
        
        <span class="k">if</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;Interactions&#39;</span><span class="p">:</span>
            <span class="n">arrow_type</span> <span class="o">=</span> <span class="s2">&quot;to from&quot;</span>
        <span class="k">elif</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;Unimolecular&#39;</span><span class="p">:</span>
            <span class="n">arrow_type</span> <span class="o">=</span> <span class="s2">&quot;to&quot;</span>
        <span class="k">elif</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;Bimolecular&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">graph_subtype</span> <span class="o">==</span> <span class="s1">&#39;product_relations&#39;</span><span class="p">:</span>
                <span class="n">arrow_type</span> <span class="o">=</span> <span class="s2">&quot;to&quot;</span>
            <span class="k">if</span> <span class="n">graph_subtype</span> <span class="o">==</span> <span class="s1">&#39;educt_relations&#39;</span><span class="p">:</span>
                <span class="n">arrow_type</span> <span class="o">=</span> <span class="s2">&quot;to from&quot;</span>
            
        <span class="c1"># g.add_node(&#39;A&#39;, shape = &#39;ellipse&#39;, opacity = 0.5, fixed = True, font = &#39;40px arial black&#39;, heightConstraint = 100, widthConstraint = 100, margin = 0)</span>
        <span class="c1"># g.add_node(&#39;B&#39;, opacity = 0.5)</span>
        <span class="c1"># g.add_edge(&#39;A&#39;,&#39;B&#39;, arrows = &quot;to from&quot;, dashes = True, length = 200, shadow = True, smooth = True)</span>
        <span class="c1"># g.add_edge(&#39;B&#39;,&#39;A&#39;, arrows = &quot;to from&quot;, dashes = True, length = 200)</span>
        <span class="c1"># g.show(&#39;tmp.html&#39;)</span>
        
        <span class="c1"># g = Network(height=&quot;100%&quot;, width=&quot;100%&quot;, bgcolor=&quot;#222222&quot;, font_color=&quot;white&quot;, directed = True)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;70%&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">directed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">])):</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">title</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">shape</span> <span class="o">=</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;20px arial black&#39;</span><span class="p">)</span><span class="c1">#, heightConstraint = 50, widthConstraint = 50)</span>
            
        <span class="c1"># g.add_nodes(list(Nodes[&#39;index&#39;]), title = list(Nodes[&#39;name&#39;]), label = list(Nodes[&#39;name&#39;]), shape=[&#39;box&#39;]*len(Nodes[&#39;index&#39;]), color = Nodes[&#39;color&#39;], size = [10]*len(Nodes[&#39;index&#39;]))</span>
        
        <span class="c1">#, weight = Edges[&#39;rate&#39;][i]/max(Edges[&#39;rate&#39;]), value = Edges[&#39;rate&#39;][i]/max(Edges[&#39;rate&#39;])</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">])):</span>
            
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Edges</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">arrows</span> <span class="o">=</span> <span class="n">arrow_type</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shadow</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">smooth</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            
            <span class="c1"># g.add_edge(Edges[&#39;indices&#39;][i][0],Edges[&#39;indices&#39;][i][1], title=Edges[&#39;rate&#39;][i], label=str(Edges[&#39;label&#39;][i]), color = Edges[&#39;color&#39;][i], arrows = &quot;to from&quot;)</span>
        
        <span class="c1"># g.toggle_physics(False)</span>
        
        <span class="c1"># g.show_buttons(filter_=[&#39;edges&#39;, &#39;nodes&#39;, &#39;physics&#39;])</span>
        
        <span class="n">g</span><span class="o">.</span><span class="n">set_edge_smooth</span><span class="p">(</span><span class="s2">&quot;dynamic&quot;</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">barnes_hut</span><span class="p">(</span><span class="n">gravity</span><span class="o">=-</span><span class="mi">3000</span><span class="p">,</span>
        <span class="n">central_gravity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">spring_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">spring_strength</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">damping</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span> <span class="o">/</span> <span class="s1">&#39;Graphs&#39;</span><span class="p">)</span> 
        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
            <span class="c1"># directory already exists</span>
            <span class="k">pass</span>
            
        <span class="c1"># g.set_options(&#39;{&quot;layout&quot;: {&quot;randomSeed&quot;:0}}&#39;)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_path</span> <span class="o">/</span> <span class="s1">&#39;Graphs&#39;</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">graph_type</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">graph_subtype</span><span class="o">+</span><span class="s1">&#39;.html&#39;</span><span class="p">)))</span></div></div>
        
<span class="c1">#%%</span>

<span class="c1"># if __name__ == &#39;__main__&#39;:</span>
    
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Moritz F P Becker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>